<!DOCTYPE html>
<html lang="ja">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>研究計画書作成支援ツール | 看護・医療研究支援</title>
  <meta name="description" content="看護・医療分野における研究の萌芽段階から研究計画書作成までを段階的に支援する対話型Webアプリケーション" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="./style.css" />
</head>

<body>
  <!-- Header -->
  <header class="app-header" id="appHeader">
    <div class="header-left">
      <div class="logo">
        <span class="logo-icon">🔬</span>
        <h1>研究計画書作成支援ツール</h1>
      </div>
      <span class="header-badge">看護・医療研究</span>
    </div>
    <div class="header-right">
      <button class="btn-icon" id="btnExport" title="進捗を保存（JSONダウンロード）" aria-label="進捗を保存">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4" />
          <polyline points="7 10 12 15 17 10" />
          <line x1="12" y1="15" x2="12" y2="3" />
        </svg>
      </button>
      <button class="btn-icon" id="btnImport" title="進捗を読み込み（JSONアップロード）" aria-label="進捗を読み込み">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4" />
          <polyline points="17 8 12 3 7 8" />
          <line x1="12" y1="3" x2="12" y2="15" />
        </svg>
      </button>
      <input type="file" id="fileImport" accept=".json" style="display: none;" />
      <button class="btn-icon" id="btnSettings" title="API設定" aria-label="API設定">
        <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M12 15a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z" />
          <path
            d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 1 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 1 1-4 0v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 1 1-2.83-2.83l.06-.06A1.65 1.65 0 0 0 4.68 15a1.65 1.65 0 0 0-1.51-1H3a2 2 0 1 1 0-4h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 1 1 2.83-2.83l.06.06A1.65 1.65 0 0 0 9 4.68a1.65 1.65 0 0 0 1-1.51V3a2 2 0 1 1 4 0v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 1 1 2.83 2.83l-.06.06A1.65 1.65 0 0 0 19.4 9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 1 1 0 4h-.09a1.65 1.65 0 0 0-1.51 1Z" />
        </svg>
      </button>
    </div>
  </header>

  <!-- API Settings Modal -->
  <div class="modal-overlay" id="settingsModal">
    <div class="modal">
      <div class="modal-header">
        <h2>⚙️ API設定</h2>
        <button class="btn-close" id="btnCloseSettings" aria-label="閉じる">&times;</button>
      </div>
      <div class="modal-body">
        <div class="form-group">
          <label for="apiProviderSelect">API プロバイダー</label>
          <select id="apiProviderSelect" class="input">
            <option value="gemini">Google Gemini (推奨)</option>
            <option value="openai">OpenAI</option>
          </select>
        </div>
        <div class="form-group">
          <label for="apiKeyInput">APIキー</label>
          <input type="password" id="apiKeyInput" placeholder="APIキーを入力..." class="input" />
          <p class="hint">APIキーはブラウザのローカルストレージにのみ保存されます</p>
        </div>
        <div class="form-group">
          <label>
            <input type="checkbox" id="demoModeToggle" />
            デモモード（API不要 — サンプルレスポンスを使用）
          </label>
        </div>
        <button class="btn btn-primary" id="btnSaveSettings">保存</button>
      </div>
    </div>
  </div>

  <!-- Progress bar -->
  <div class="progress-container" id="progressContainer">
    <div class="progress-bar">
      <div class="progress-fill" id="progressFill" style="width: 14.28%"></div>
    </div>
    <div class="step-tabs" id="stepTabs">
      <button class="step-tab active" data-step="1">
        <span class="step-num">1</span>
        <span class="step-label">種と整理</span>
      </button>
      <button class="step-tab" data-step="2">
        <span class="step-num">2</span>
        <span class="step-label">デザイン案</span>
      </button>
      <button class="step-tab" data-step="3">
        <span class="step-num">3</span>
        <span class="step-label">ガイドライン</span>
      </button>
      <button class="step-tab" data-step="4">
        <span class="step-num">4</span>
        <span class="step-label">文献レビュー</span>
      </button>
      <button class="step-tab" data-step="5">
        <span class="step-num">5</span>
        <span class="step-label">データ収集</span>
      </button>
      <button class="step-tab" data-step="6">
        <span class="step-num">6</span>
        <span class="step-label">分析方法</span>
      </button>
      <button class="step-tab" data-step="7">
        <span class="step-num">7</span>
        <span class="step-label">計画書草案</span>
      </button>
    </div>
  </div>

  <!-- Main content -->
  <main class="main-layout" id="mainLayout">
    <!-- Left: Step content -->
    <div class="step-content" id="stepContent">
      <!-- Steps will be rendered here by JS -->
    </div>

    <!-- Right: Research structure summary -->
    <aside class="summary-panel" id="summaryPanel">
      <div class="summary-header">
        <h2>📋 研究構造ビュー</h2>
      </div>
      <div class="summary-body" id="summaryBody">
        <div class="summary-item" data-summary="theme">
          <div class="summary-label">テーマ</div>
          <div class="summary-value" id="sumTheme">未入力</div>
        </div>
        <div class="summary-item" data-summary="rq">
          <div class="summary-label">リサーチクエスチョン</div>
          <div class="summary-value" id="sumRQ">未確定</div>
        </div>
        <div class="summary-item" data-summary="design">
          <div class="summary-label">研究デザイン</div>
          <div class="summary-value" id="sumDesign">未選択</div>
        </div>
        <div class="summary-item" data-summary="guideline">
          <div class="summary-label">準拠ガイドライン</div>
          <div class="summary-value" id="sumGuideline">未選択</div>
        </div>
        <div class="summary-item" data-summary="literature">
          <div class="summary-label">文献レビュー</div>
          <div class="summary-value" id="sumLiterature">未実施</div>
        </div>
        <div class="summary-item" data-summary="data">
          <div class="summary-label">収集データ</div>
          <div class="summary-value" id="sumData">未選択</div>
        </div>
        <div class="summary-item" data-summary="analysis">
          <div class="summary-label">分析手法</div>
          <div class="summary-value" id="sumAnalysis">未提案</div>
        </div>
      </div>
    </aside>
  </main>

  <!-- Navigation -->
  <nav class="step-nav" id="stepNav">
    <button class="btn btn-outline" id="btnPrev" disabled>
      <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M19 12H5" />
        <path d="m12 19-7-7 7-7" />
      </svg>
      前のステップ
    </button>
    <span class="step-indicator" id="stepIndicator">Step 1 / 7</span>
    <button class="btn btn-primary" id="btnNext">
      確認して次へ
      <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M5 12h14" />
        <path d="m12 5 7 7-7 7" />
      </svg>
    </button>
  </nav>

  <script type="module" src="./src/main.js"></script>
</body>

</html>