/**
 * prompts/index.js — AI system prompts and demo responses for each module
 */

// ===========================
//  SYSTEM PROMPTS
// ===========================

export const PROMPTS = {
    designSelection: `あなたは看護・医療研究デザインの専門アドバイザーです。
ユーザーが入力した「現場の課題・疑問」「対象」「方向性」から、最適な研究デザインを最大3案提案してください。

研究タイプ候補:
- QI（質改善）
- 事例／実践報告
- 実態調査（記述研究）
- 横断研究
- 介入研究
- 前後比較研究
- 探索的研究
- 混合研究法

各提案には以下を含めてください:
1. 研究デザイン名
2. 適合理由（3〜4文）
3. 必要な倫理的配慮の概要
4. おすすめ度（★★★/★★/★）

回答はJSON形式で返してください:
{
  "proposals": [
    {
      "design": "研究デザイン名",
      "reason": "適合理由",
      "ethics": "倫理的配慮",
      "rating": 3
    }
  ]
}`,

    rqAssistant: `あなたは看護・医療研究のリサーチクエスチョン整理を支援するアドバイザーです。
対話を通じて以下の要素を順番に整理してください:

1. P (Population/対象)
2. I/E (Intervention/Exposure/介入・曝露)
3. C (Comparison/比較)
4. O (Outcome/アウトカム)
5. 研究デザイン

対話的に一つずつ確認し、全要素が揃ったら以下の形式で整理して提示:
- PICO形式
- PECO形式
- SPIDER形式（質的研究の場合）
- SMART形式（QI研究の場合）

やさしく丁寧な日本語で、看護研究の初心者にもわかるように説明してください。`,

    literatureReview: `あなたは看護・医療分野の文献レビュー支援AIです。
ユーザーの研究テーマに基づいて以下を生成してください:

1. PubMed検索式（MeSH用語を含む）
2. Inclusion/Exclusion基準の整理
3. 先行研究のテーマ分類案
4. 研究ギャップの抽出
5. ナラティブ要約
6. 研究マトリクス表のテンプレート

結果はJSON形式で返してください:
{
  "searchQuery": "検索式",
  "inclusion": ["基準1", ...],
  "exclusion": ["基準1", ...],
  "themes": ["テーマ1", ...],
  "gaps": ["ギャップ1", ...],
  "narrative": "要約テキスト",
  "matrix": [{"author":"","year":"","design":"","sample":"","findings":""}]
}`,

    statisticsProposal: `あなたは看護・医療研究の統計分析アドバイザーです。
収集データの特性（データタイプ、サンプルサイズ、群分け）を基に最適な分析方法を提案してください。

判断基準:
- 連続変数 vs カテゴリ変数
- 正規分布想定の有無
- 群比較 vs 関連分析

提案内容:
1. 主解析（検定方法の名称と選択理由）
2. 副解析の候補
3. 効果量の推定方法
4. 多変量解析の必要性
5. サンプルサイズの概算（可能な範囲で）

結果はJSON形式で:
{
  "primaryAnalysis": {"method": "", "reason": ""},
  "secondaryAnalyses": [{"method": "", "reason": ""}],
  "effectSize": "",
  "multivariateNeeded": true/false,
  "multivariateMethod": "",
  "sampleSizeNote": ""
}`,

    proposalDraft: `あなたは看護・医療分野の研究計画書作成支援AIです。
以下の構造で研究計画書草案を日本語で作成してください:

1. 研究背景
2. 研究目的
3. 研究方法
   - 研究デザイン
   - 対象者
   - データ収集方法
   - 分析方法
4. 倫理的配慮
5. 期待される成果
6. 研究の限界
7. 準拠ガイドライン

学術的かつ読みやすい文章で、看護研究の初心者でも理解できるよう心がけてください。`,
};

// ===========================
//  DEMO RESPONSES
// ===========================

export const DEMO_RESPONSES = {
    default: 'これはデモモードのレスポンスです。実際のAI連携にはAPIキーを設定してください。',

    designSelection: JSON.stringify({
        proposals: [
            {
                design: '横断研究（Cross-sectional Study）',
                reason: '入力された疑問の性質から、ある時点における現象の実態を把握することが重要です。横断研究は比較的短期間で実施でき、現状の関連要因を探索するのに適しています。倫理審査も比較的通りやすい研究デザインです。',
                ethics: '個人情報の保護、同意取得、データの匿名化処理が必要です。施設の倫理委員会への申請が必須となります。',
                rating: 3,
            },
            {
                design: '実態調査（記述研究/Descriptive Study）',
                reason: 'まだ十分に明らかにされていないテーマについて、現場の実態を記述・整理することが有用です。質問紙調査やインタビューを組み合わせることで、現象の全体像を把握できます。',
                ethics: '調査対象者への十分な説明と同意取得、回答の任意性の保証が重要です。',
                rating: 2,
            },
            {
                design: 'QI（質改善/Quality Improvement）',
                reason: '現場の課題を直接改善することを目的とする場合、PDCA サイクルに基づくQIプロジェクトが実践的です。即座に現場の改善につなげられるメリットがあります。',
                ethics: 'QIは通常の臨床業務改善として位置づけられますが、結果を公表する場合は倫理審査が必要になる場合があります。',
                rating: 2,
            },
        ],
    }),

    rqAssistant: 'ありがとうございます。研究テーマの整理を始めましょう。\n\nまず、**対象（Population）**について教えてください。\n\n- どのような患者さんや対象者を研究対象として考えていますか？\n- 年齢層、疾患、入院・外来の別など、具体的な条件はありますか？',

    rqFormats: JSON.stringify({
        pico: {
            P: '急性期病院に入院中の高齢患者（65歳以上）',
            I: '多職種による退院支援プログラム',
            C: '通常の退院支援',
            O: '30日以内の再入院率、患者満足度',
        },
        peco: {
            P: '急性期病院に入院中の高齢患者（65歳以上）',
            E: '多職種による退院支援プログラムへの参加',
            C: '通常の退院支援のみ',
            O: '30日以内の再入院率、患者満足度',
        },
        spider: {
            S: '急性期病院',
            PI: '高齢患者の退院支援体験',
            D: '質的記述的研究',
            E: 'インタビュー調査',
            R: '退院支援に対する認識と体験',
        },
        smart: {
            S: '退院後30日以内の再入院率を',
            M: '10%削減する',
            A: '多職種カンファレンスと退院時指導の標準化により',
            R: '病棟全体の目標として',
            T: '6ヶ月以内に達成する',
        },
    }),

    literatureReview: JSON.stringify({
        searchQuery: '("Patient Discharge"[MeSH] OR "discharge planning") AND ("Aged"[MeSH] OR elderly OR "older adults") AND ("Patient Readmission"[MeSH] OR readmission) AND (nurs*)',
        inclusion: [
            '65歳以上の高齢患者を対象とした研究',
            '退院支援に関する介入または観察研究',
            '再入院率をアウトカムとして測定',
            '査読付き英語または日本語論文',
            '過去5年以内に出版',
        ],
        exclusion: [
            '小児・産科を対象とした研究',
            '精神科領域の研究',
            'プロトコル論文のみ',
            '学会抄録のみ',
        ],
        themes: [
            '退院支援プログラムの構成要素',
            '多職種連携の効果',
            '患者教育と自己管理支援',
            '再入院リスク評価ツール',
        ],
        gaps: [
            '日本の急性期病院における多職種退院支援の効果検証は限定的',
            '高齢患者の退院支援における看護師の独自の役割の明確化が不十分',
            '費用対効果の分析が不足',
        ],
        narrative: '高齢患者の退院支援と再入院予防に関する文献は増加傾向にあり、特に多職種連携の有効性が報告されています。しかし、日本の医療制度に特化した研究は依然として限られており、文化的要因や地域特性を考慮した介入プログラムの開発と評価が求められています。',
        matrix: [
            { author: 'Tanaka et al.', year: '2023', design: 'RCT', sample: 'n=120', findings: '多職種退院支援により再入院率が15%低下' },
            { author: 'Smith et al.', year: '2022', design: 'Cohort', sample: 'n=500', findings: '退院時指導の強化が患者満足度向上に寄与' },
            { author: 'Yamada et al.', year: '2024', design: '横断研究', sample: 'n=300', findings: '看護師の退院支援実践と経験年数に正の相関' },
        ],
    }),

    statisticsProposal: JSON.stringify({
        primaryAnalysis: {
            method: '対応のないt検定 / Mann-Whitney U検定',
            reason: '2群間の連続変数の比較には、正規分布が仮定できる場合はt検定を、できない場合はMann-Whitney U検定を使用します。',
        },
        secondaryAnalyses: [
            { method: 'χ²検定', reason: 'カテゴリカル変数（再入院の有無など）の群間比較に使用' },
            { method: 'ロジスティック回帰分析', reason: '再入院に関連する独立した要因を特定するために使用' },
        ],
        effectSize: "Cohenのd（連続変数）、オッズ比（カテゴリ変数）を算出",
        multivariateNeeded: true,
        multivariateMethod: '多変量ロジスティック回帰分析（年齢、性別、疾患重症度などの交絡因子を調整）',
        sampleSizeNote: '有意水準α=0.05、検出力80%、中程度の効果量(d=0.5)を想定した場合、各群64例、合計128例が必要（G*Powerによる概算）',
    }),

    proposalDraft: `# 研究計画書（草案）

## 1. 研究背景

高齢化が進む日本の医療現場において、急性期病院からの退院後の再入院は、患者のQOL低下と医療費増大の両面で重要な課題となっている。厚生労働省の統計によると、75歳以上の高齢者の退院後30日以内の再入院率は約15%であり、その予防は喫緊の課題である。

近年、多職種による退院支援プログラムの有効性が海外では報告されているが、日本の医療制度・文化に適した介入プログラムの効果検証は十分に行われていない。

## 2. 研究目的

急性期病院に入院する65歳以上の高齢患者を対象に、多職種連携退院支援プログラムが退院後30日以内の再入院率と患者満足度に及ぼす影響を明らかにする。

## 3. 研究方法

### 3.1 研究デザイン
準実験研究（前後比較デザイン）

### 3.2 対象者
- 対象：A病院に入院する65歳以上の患者
- 選択基準：入院期間7日以上、退院後の自宅復帰を予定
- 除外基準：認知機能の著しい低下（MMSE 20点未満）、終末期患者
- 予定症例数：介入群・対照群 各64例（合計128例）

### 3.3 データ収集方法
- 基本属性（年齢、性別、疾患名、ADL）
- 30日以内再入院の有無
- 患者満足度（リッカート尺度）
- 退院支援プログラムの実施状況

### 3.4 分析方法
- 主解析：t検定またはMann-Whitney U検定（連続変数）、χ²検定（カテゴリ変数）
- 多変量解析：ロジスティック回帰分析
- 効果量：Cohenのd、オッズ比
- 有意水準：p < 0.05

## 4. 倫理的配慮

- 所属機関の倫理委員会の承認を得る
- 対象者に研究の目的・方法を文書で説明し、書面による同意を得る
- 参加は自由意志であり、途中辞退による不利益がないことを保証する
- データは匿名化し、研究目的以外に使用しない
- データは施錠可能な場所に保管し、研究終了後5年で廃棄する

## 5. 期待される成果

本研究の結果は、日本の急性期病院における効果的な退院支援モデルの構築に貢献し、高齢患者の再入院予防と医療の質向上に寄与することが期待される。

## 6. 研究の限界

- 単施設研究であるため、一般化可能性に限界がある
- 前後比較デザインのため、介入効果の因果関係の推定に制約がある
- 患者の退院後の生活状況など、測定困難な交絡因子が存在する可能性がある

## 7. 準拠ガイドライン

STROBE声明（観察研究の報告ガイドライン）に準拠して報告する。
`,
};
